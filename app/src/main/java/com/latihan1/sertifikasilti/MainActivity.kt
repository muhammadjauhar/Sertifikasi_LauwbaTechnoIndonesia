package com.latihan1.sertifikasiltiimport android.app.ProgressDialogimport android.content.Intentimport androidx.appcompat.app.AppCompatActivityimport android.os.Bundleimport android.util.Logimport android.view.Viewimport android.widget.ProgressBarimport android.widget.Toastimport androidx.appcompat.app.ActionBarimport com.androidnetworking.AndroidNetworkingimport com.androidnetworking.common.Priorityimport com.androidnetworking.error.ANErrorimport com.androidnetworking.interfaces.JSONObjectRequestListenerimport kotlinx.android.synthetic.main.activity_main.*import org.json.JSONArrayimport org.json.JSONObjectclass MainActivity : AppCompatActivity() {    lateinit var jsonArray : JSONArray//    lateinit var progressBar: ProgressBar    override fun onCreate(savedInstanceState: Bundle?) {        super.onCreate(savedInstanceState)        setContentView(R.layout.activity_main)//        title = "Memuat Data"//        progressBar = findViewById(R.id.pb)//        progressBar.max = 100//        progressBar.progress = 20        login.setOnClickListener {            val telp = telp.text.toString()            val sertifikat = sertifikat.text.toString()            Log.d("telp", telp)            Log.d("sertifikat", sertifikat)            if (telp.isEmpty() || sertifikat.isEmpty()) {                Toast.makeText(                    this,                    "Please Insert No.Telp and No. Sertifikat",                    Toast.LENGTH_SHORT                ).show()            } else {                login(telp,sertifikat)            }//            if (telp == "0123" || sertifikat == "ser123") {//                val progressDialog = ProgressDialog(//                    this,//                    R.style.Theme_MaterialComponents_Light_Dialog//                )//                progressDialog.isIndeterminate = true//                progressDialog.setMessage("Loading...")//                progressDialog.show()//                val intent = Intent(this, MenuPilihan::class.java)//                startActivity(intent)//                finish()//            }        }    }    fun login (no_telp : String, no_sertifikat : String){        showLoading(true)        AndroidNetworking.get("https://server4111.com/db_sertifikat/index.php/ApiDetailSertifikat/detailsertifikat/$no_sertifikat/$no_telp")            .setPriority(Priority.MEDIUM)            .build()            .getAsJSONObject(object : JSONObjectRequestListener {                override fun onResponse(response: JSONObject) {                    val status = response.getInt("status")!!                        if(status == 0) {                            jsonArray = response?.optJSONArray("data")!!                            if (jsonArray.length() == null) {                                Toast.makeText(this@MainActivity, "Data Kosong", Toast.LENGTH_LONG).show()                            }else{//                                progressBar.visibility = View.GONE                                val jsonObject = jsonArray.optJSONObject(0)                                val no_sertifikat = jsonObject.getString("no_sertifikat")                                val no_telp = jsonObject.getString("no_hp")                                val nama = jsonObject.getString("nama")                                val email = jsonObject.getString("email")                                val jadwal_pelaksanaan = jsonObject.getString("jadwal_pelaksanaan")                                val nama_perusahaan = jsonObject.getString("nama_perusahaan")                                val jabatan = jsonObject.getString("jabatan")                                val kota_pelaksanaan = jsonObject.getString("kota_pelaksanaan")                                val info = jsonObject.getString("info")                                val motivasi = jsonObject.getString("motivasi")                                val ket_tambahan = jsonObject.getString("ket_tambahan")//                                val status = jsonObject.getString("status")//                                val akses = jsonObject.getString("akses")                                val i = Intent(this@MainActivity, MenuPilihan:: class.java)                                i.putExtra("extra_nosertifikat",  no_sertifikat)                                i.putExtra("extra_notelp", no_telp)                                i.putExtra("extra_nama", nama)                                i.putExtra("extra_email", email)                                i.putExtra("extra_jadwal_pelaksanaan", jadwal_pelaksanaan)                                i.putExtra("extra_nama_perusahaan", nama_perusahaan)                                i.putExtra("extra_jabatan", jabatan)                                i.putExtra("extra_kota_pelaksanaan", kota_pelaksanaan)                                i.putExtra("extra_info", info)                                i.putExtra("extra_motivasi", motivasi)                                i.putExtra("extra_ket_tambahan", ket_tambahan)//                                i.putExtra("extra_status", status)//                                i.putExtra("extra_akses", akses)                                startActivity(i)                            }                        } else {                            Toast.makeText(this@MainActivity, "Data tidak ditemukan!!", Toast.LENGTH_SHORT).show()                        }                    showLoading(false)                }                override fun onError(error: ANError) {                    Toast.makeText(this@MainActivity, "Login Gagal", Toast.LENGTH_SHORT).show()                    error.printStackTrace()                    Log.d("FAN-ERROR", "onError errorCode : " + error.getErrorCode());                    Log.d("FAN-ERROR", "onError errorBody : " + error.getErrorBody());                    Log.d("FAN-ERROR", "onError errorDetail : " + error.getErrorDetail());                    Log.d("FAN-ERROR", error.errorDetail)                }            })    }    private fun showLoading(state: Boolean){        if (state){            pb.visibility = View.VISIBLE        }        else {            pb.visibility = View.GONE        }    }}